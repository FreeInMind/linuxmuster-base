# patching sophomorix.conf with schoolname, location and servername

sed -e "s/^\$schul_name=.*/\$schul_name=\"${schoolname} ${location}\";/
        s/^\$smb_netbios_name =.*/\$smb_netbios_name = \"${servername}\";/" $SOPHOMORIXCONF > $SOPHOMORIXCONF.tmp

mv $SOPHOMORIXCONF.tmp $SOPHOMORIXCONF

# patch sophomorix pgldap.conf with workgroup, server, internip and domainname
sed -e "s/^\$domainname=.*/\$domainname=\"${domainname}\";/
        s/^\$servername=.*/\$servername=\"${servername}\";/
        s/^\$internip=.*/\$internip=\"${serverip}\";/
        s/^\$smbworkgroup=.*/\$smbworkgroup=\"${workgroup}\";/" /etc/sophomorix/pgldap/pgldap.conf > /etc/sophomorix/pgldap/pgldap.conf.tmp
cp -f /etc/sophomorix/pgldap/pgldap.conf.tmp /etc/sophomorix/pgldap/pgldap.conf && rm -f /etc/sophomorix/pgldap/pgldap.conf.tmp
chmod 600 /etc/sophomorix/pgldap/pgldap.conf
